<!DOCTYPE html>
<html>
<head>
  <title>Achievements Admin</title>
  <style>
    body { font-family: sans-serif; max-width: 500px; margin: 50px auto; }
    input, textarea { width: 100%; margin-bottom: 10px; padding: 8px; }
    button { padding: 10px 15px; cursor: pointer; }
    #login-section, #form-section { margin-top: 20px; }
  </style>
</head>
<body>

<h2>Achievements Admin</h2>

<!-- LOGIN SECTION -->
<div id="login-section">
  <input type="text" id="username" placeholder="Username">
  <input type="password" id="password" placeholder="Password">
  <button onclick="login()">Login</button>
</div>

<!-- FORM SECTION -->
<div id="form-section" style="display:none;">
  <input id="title" placeholder="Title">
  <input id="date" type="date">
  <textarea id="desc" placeholder="Description"></textarea>
  <input type="file" id="image" accept="image/*"><br><br>
  <button onclick="addAchievement()">Add Achievement</button>
</div>

<script>
  const ADMIN_USER = "admin";
  const ADMIN_PASS = "1234"; // change if needed
  const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxc3gGKh1yyCzQkwPO28zGBg0Fh6GrI5o5SwxDoXtfUi0hjA9NDmBvxu-4pNgHl1-lg/exec";

  // ===== LOGIN =====
  function login() {
    const user = document.getElementById("username").value;
    const pass = document.getElementById("password").value;

    if(user === ADMIN_USER && pass === ADMIN_PASS) {
      document.getElementById("login-section").style.display = "none";
      document.getElementById("form-section").style.display = "block";
      alert("Login successful!");
    } else {
      alert("Invalid username or password!");
    }
  }

  // ===== ADD ACHIEVEMENT =====
  function addAchievement() {
    const title = document.getElementById("title").value;
    const date = document.getElementById("date").value;
    const desc = document.getElementById("desc").value;
    const fileInput = document.getElementById("image");

    if(!title || !date || !desc || fileInput.files.length === 0) {
      alert("Please fill all fields and select an image!");
      return;
    }

    const file = fileInput.files[0];
    const reader = new FileReader();

    reader.onload = function(e) {
      const base64Image = e.target.result;

      fetch(WEB_APP_URL, {
        method: "POST",
        body: JSON.stringify({
          title: title,
          date: date,
          description: desc,
          imageBase64: base64Image,
          imageName: file.name
        }),
        headers: { "Content-Type": "application/json" }
      })
      .then(res => res.json())
      .then(data => {
        if(data.success) {
          alert("Achievement added successfully!");
          document.getElementById("title").value = "";
          document.getElementById("date").value = "";
          document.getElementById("desc").value = "";
          document.getElementById("image").value = "";
        } else {
          alert("Error: " + data.error);
        }
      })
      .catch(err => alert("Request failed: " + err.message));
    };

    reader.readAsDataURL(file);
  }
</script>

</body>
</html>
